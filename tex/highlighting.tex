% Highlightning System
% The following boxes are provided:
%   Definition:     \defn
%   Theorem:        \thm
%   Example:        \ex
% Suffix
%   r:              Allow Theorem/Definition to be referenced, e.g. thmr
%   p:              Add a short proof block for Lemma, Corollary,

% ======= Real examples :

% \defn{Definition Name}{
%     A defintion.
% }

% \thmr{Theorem Name}{mybigthm}{
%     A theorem.
% }

% \clmp{}{
%     A claim.
% }{
%     A reference to Theorem~\ref{thm:mybigthm}
% }

% \ex{
%     some examples.
% }

\usepackage{tcolorbox} % Основной пакет
\tcbuselibrary{theorems,listings,skins,breakable} % Библиотека для теорем
\usepackage{amssymb} % Для символа \blacksquare
\usepackage{xcolor}
\usepackage{listings}

% Define custom colors
\definecolor{defscol}{HTML}{ecd8d7} %For definitions
\definecolor{asumscol}{HTML}{FFCBA4} %For Assumptions Насыщенный персиковый

\definecolor{clmscol}{HTML}{e04b52} %For examples

\definecolor{thmscol}{HTML}{595765} %For Theorems

\definecolor{Code}{rgb}{0,0,0}
\definecolor{Decorators}{rgb}{0.5,0.5,0.5}
\definecolor{Numbers}{rgb}{0.5,0,0}
\definecolor{MatchingBrackets}{rgb}{0.25,0.5,0.5}
\definecolor{Keywords}{rgb}{0,0,1}
\definecolor{self}{rgb}{0,0,0}
\definecolor{Strings}{rgb}{0,0.63,0}
\definecolor{Comments}{rgb}{0,0.63,1}
\definecolor{Backquotes}{rgb}{0,0,0}
\definecolor{Classname}{rgb}{0,0,0}
\definecolor{FunctionName}{rgb}{0,0,.7}
\definecolor{Operators}{rgb}{0,0,0}
\definecolor{Background}{rgb}{0.98,0.98,0.98}
\definecolor{facscol}{HTML}{28a8a1} %For facts
\definecolor{softmint}{RGB}{200, 255, 200} % Менее яркий салатовый

% ============================
% Определение
% ============================
\newtcbtheorem[number within=section]{mydefinition}{Определение} %%
% Подбирает номер секции
{
  enhanced,
  frame hidden,
  titlerule=0mm,
  toptitle=1mm,
  bottomtitle=1mm,
  fonttitle=\bfseries\large,
  coltitle=black,
  colbacktitle=defscol!40!white,
  colback=defscol!20!white,
}{defn}

\NewDocumentCommand{\defn}{m+m}{
  \begin{mydefinition}{#1}{}
    #2
  \end{mydefinition}
}

%\NewDocumentCommand{\defnr}{mm+m}{
%  \begin{mydefinition}{#1}{#2}
%    #3
%  \end{mydefinition}
%}

%% ============================
%% Бизнес-кейс
%% ============================

%\newtcbtheorem[use counter from=mydefinition]{myfact}{Бизнесс-кейс}
%{
%  enhanced,
%  frame hidden,
%  titlerule=0mm,
%  toptitle=1mm,
%  bottomtitle=1mm,
%  fonttitle=\bfseries\large,
%  coltitle=black,
%  colbacktitle=defscol!40!white,
%  colback=defscol!20!white,
%  opacityback=0.4, % Параметр, который отвечает за прозрачность
%  opacitybacktitle=0.5
%}{fact}

\newtcbtheorem[use counter from=mydefinition]{myfact}{Кейс}
{
  enhanced,
  frame hidden,
  titlerule=0mm,
  toptitle=1mm,
  bottomtitle=1mm,
  fonttitle=\bfseries\large,
  coltitle=black,
  colbacktitle=facscol!40!white,
  colback=facscol!20!white,
  opacityback=0.4, % Параметр, который отвечает за прозрачность
  opacitybacktitle=0.5
}{fact}

\NewDocumentCommand{\case}{+m}{
  \begin{myfact}{}{}
    #1
  \end{myfact}
}

%% ============================
%% Предпосылка
%% ============================
\newtcbtheorem[use counter from=mydefinition]{myassumption}{Предпосылка}
{
  enhanced,
  frame hidden,
  titlerule=0mm,
  toptitle=1mm,
  bottomtitle=1mm,
  fonttitle=\bfseries\large,
  coltitle=black,
  colbacktitle=asumscol!40!white,
  colback=asumscol!20!white,
}{asum}

\NewDocumentCommand{\asum}{m+m}{
  \begin{myassumption}{#1}{}
    #2
  \end{myassumption}
}

%\NewDocumentCommand{\asumr}{mm+m}{
%  \begin{myassumption}{#1}{#2}
%    #3
%  \end{myassumption}
%}

%% ============================
%% Теорема
%% ============================

% TODO: разобраться, как сделать попрозрачнее
\newtcbtheorem[use counter from=mydefinition]{mytheorem}{Теорема}
{
  enhanced,
  frame hidden,
  titlerule=0mm,
  toptitle=1mm,
  bottomtitle=1mm,
  fonttitle=\bfseries\large,
  coltitle=black,
  colbacktitle=thmscol!40!white,
  colback=thmscol!20!white,
}{thm}

\NewDocumentCommand{\theorem}{m+m}{
  \begin{mytheorem}{#1}{}
    #2
  \end{mytheorem}
}

%\NewDocumentCommand{\theoremr}{mm+m}{
%  \begin{mytheorem}{#1}{#2}
%    #3
%  \end{mytheorem}
%}

%% ============================
%% Контрольные вопросы
%% ============================
\newenvironment{pr_questions}{
  \tcolorbox[blanker,breakable,left=5mm,parbox=false,
    before upper={\parindent15pt},
    after skip=10pt,
    borderline west={1mm}{0pt}{softmint!70!white}, % Более мягкий цвет
  colback=white!0] % Прозрачный фон
}{
  \endtcolorbox
}

\NewDocumentCommand{\question}{m+m}{
  \begin{pr_questions}
    {\noindent{\it \textbf{\large{Контрольные вопросы} : #1 }}}\\
    \begin{enumerate}
        #2
    \end{enumerate}
  \end{pr_questions}
}

%% ============================
%% Пример
%% ============================

\newenvironment{myexample}{
  \tcolorbox[blanker,breakable,left=5mm,parbox=false,
    before upper={\parindent15pt},
    after skip=10pt,
  borderline west={1mm}{0pt}{clmscol!40!white}]
}{
  \textcolor{clmscol!40!white}{\hbox{}\nobreak\hfill$\blacksquare$}
  \endtcolorbox
}

\NewDocumentCommand{\ex}{m+m}{
  \begin{myexample}
    {\noindent{\it \textbf{Пример : #1 }}}\\
    #2
  \end{myexample}
}

%% ============================
%% Контрольные вопросы
%% ============================

%\newenvironment{questions}{
%  \tcolorbox[blanker,breakable,left=5mm,parbox=false,
%    before upper={\parindent15pt},
%    after skip=10pt,
%  borderline west={1mm}{0pt}{clmscol!40!white}]
%}{
%  \textcolor{clmscol!40!white}{\hbox{}\nobreak\hfill$\blacksquare$}
%  \endtcolorbox
%}

%\NewDocumentCommand{\question}{m+m}{
%  \begin{questions}
%    {\noindent{\it \textbf{\large{Контрольные вопросы} : #1 }}}\\
%    \begin{enumerate}
%        #2
%    \end{enumerate}
%  \end{questions}
%}

\lstdefinestyle{python}{
  numbers=left,
  numberstyle=\footnotesize,
  numbersep=1em,
  xleftmargin=1em,
  framextopmargin=2em,
  framexbottommargin=2em,
  showspaces=false,
  showtabs=false,
  showstringspaces=false,
  frame=l,
  tabsize=4,
  % Basic
  basicstyle=\ttfamily\small\setstretch{1},
  backgroundcolor=\color{Background},
  language=Python,
  % Comments
  commentstyle=\color{Comments}\slshape,
  % Strings
  stringstyle=\color{Strings},
  morecomment=[s][\color{Strings}]{"""}{"""},
  morecomment=[s][\color{Strings}]{'''}{'''},
  % keywords
  morekeywords={import,from,class,def,for,while,if,is,in,elif,else,not,and,or,print,break,continue,return,True,False,None,access,as,,del,except,exec,finally,global,import,lambda,pass,print,raise,try,assert},
  keywordstyle={\color{Keywords}\bfseries},
  % additional keywords
  morekeywords={[2]@invariant},
  keywordstyle={[2]\color{Decorators}\slshape},
  emph={self},
  emphstyle={\color{self}\slshape},
  breaklines=true
}
